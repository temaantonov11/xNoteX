## Процессы

Программа становится процессом
- "Место обитания" программы на диске. Процесса - в ОЗУ.
- У каждого процесса есть свое собственное **адресное пространство**, абстрактный процессор и **единственный поток управления**
- Процесс не знает о "мире" за пределами своего адресного пространства. Более того, он считает, что существуют только те ресурсы, которые были выделены.
- Можно запустить несколько прцоессов одной программы

![[Pasted image 20250113183235.png]]

### Состояния процесса в Unix

![[Pasted image 20250113183315.png]]

![[Pasted image 20250113183348.png]]

### Переключение процессов (контекста)
На кухню вбегает родственник кулинара и кричит, что его ужалила пчела. Кулинар записывает место, где он остановился (**сохранение состояния текущего процесса**), достает книгу по оказанию первой помощи и приступает к выполнению инструкций. 

### Очередь процессов
![[Pasted image 20250113184207.png]]

## Планировщик

>[!tip] Зачем нужен планировщик?
>Планировщик решает какой **процесс запустить следующим**.
>

### Проблематика
- Ограниченность времени CPU (ресурсов CPU).
- Обеспечение целевого времени отклика.
- Грамотная утилизация ресурсов (минимизировать кол-во дорогостоящих переключений).
- Желание обесмечить оптимальную работы.
	- быстродейтсвие, энергоэффективность, real-time, особенности архитектуры (гибридные ядра), IO-bound.
- Как отличить более приоритетную задачу (процесс) от менее приоритетной?
- Неочевидные "фишки" современных CPU архитектур ( к примеру, что выгоднее с точки зрения энергоэффективности: проработать мало времени на большой частоте или много на маленькой частоте?)
- Возможность динамической адаптации (к примеру, режим энергосбережения).
- Алгоритм должен быть быстрым и "лёгким".

### Примеры алгоритмов планирования

- **Алгоритм первоочередного выполнения самого краткого задания**
	- Первым пришел - первым обслужен.
	- Первым взять самую простую задачу.
- **Циклическое**
	- Каждому процессу назначены окна выполнения - не успел - доработаешь в следующей в следующей итерации.
- **Приоритетное**
	- Первым исполнится процесс с наивысшим приоритетом.
- **Многоуровневая очередь**
- **Гарантированное**
- **Лотерейное**
	- Лотерея, но более приоритетным процессом выдаем больше билетов, с целью повышения шанса
- **Справедливое**
- **Планирование в системах реального времени**
	- Процесс должен исполнится только в строго отведенное ему время.

### Как пользователь может повлиять на алгоритм планирования в Linux?

- affinity
- nice (process priority)
- real-time process
- дизайн и особенность работы выполняемых программ
- собрать ядро с любимым алгоритмом


### Linux scheduler
- v2.4 - O(n) scheduler
- v2.6 - O(1) scheduler
- v2.6.23 - Completely Fair Scheduler (CFS)
- v6.6 (2024) - Earliest eligible virtual deadline first (EEVDF)